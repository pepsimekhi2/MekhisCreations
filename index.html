<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mekhis Creations</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4285F4;
            --secondary: #34A853;
            --accent: #EA4335;
            --text: #202124;
            --bg: #F8F9FA;
            --card-bg: #fff;
            --btn-text: #fff;
            --input-bg: #fff;
            --theme-gradient: linear-gradient(135deg, #4285F4, #34A853, #EA4335);
            --gradient-size: 400% 400%
        }

        body {
    font-family: 'Fredoka One', cursive;
    background: var(--theme-gradient) fixed;
    color: var(--text);
    margin: 0;
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: all .5s ease-in-out;
}

#profile-header {
    display: flex;
    align-items: center;
    gap: 20px;
    margin-bottom: 30px;
    padding: 20px;
    background: var(--card-bg);
    border-radius: 15px;
    box-shadow: 0 5px 20px rgba(0,0,0,.15);
}

#profile-headshot {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    border: 5px solid var(--primary);
}

#profile-info {
    flex: 1;
}

#profile-info h1 {
    font-size: 28px;
    margin: 0;
    color: var(--primary);
}

#profile-info p {
    margin: 10px 0 0;
    color: var(--text);
    font-size: 16px;
}

#profile-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 20px;
    margin: 20px 0;
}

.stat {
    text-align: center;
    padding: 15px;
    background: var(--card-bg);
    border-radius: 10px;
    box-shadow: 0 3px 10px rgba(0,0,0,.1);
}

.stat-value {
    font-size: 24px;
    color: var(--primary);
    font-weight: bold;
}

.stat-label {
    color: var(--text);
    font-size: 14px;
}

#profile-actions {
    display: flex;
    gap: 10px;
    justify-content: center;
    margin-top: 20px;
}

#profile-actions button {
    background: var(--primary);
    color: var(--btn-text);
    border: none;
    padding: 10px 20px;
    border-radius: 50px;
    cursor: pointer;
    transition: all .3s ease-in-out;
}

#profile-actions button:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(0,0,0,.15);
}

#theme-btn {
    position: fixed;
    top: 20px;
    right: 20px;
    background: var(--primary);
    color: var(--btn-text);
    border: none;
    padding: 10px 20px;
    border-radius: 50px;
    cursor: pointer;
    transition: all .3s ease-in-out;
}

#theme-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(0,0,0,.15);
}

#theme-menu {
    position: fixed;
    top: 80px;
    right: 20px;
    background: var(--card-bg);
    border-radius: 15px;
    padding: 15px;
    box-shadow: 0 5px 20px rgba(0,0,0,.15);
}

.theme-option {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px;
    border-radius: 10px;
    cursor: pointer;
    transition: all .3s ease-in-out;
}

.theme-option:hover {
    background: rgba(255,255,255,.1);
}

        .theme-option.selected {
            background: var(--primary);
            color: var(--btn-text);
        }

        .color-preview {
            width: 30px;
            height: 30px;
            border-radius: 50%;
        }
    </style>
</head>
<body>
    <script>
        const styles = {
            light: {
                text: '#202124',
                bg: '#F8F9FA',
                cardBg: '#fff',
                btnText: '#fff',
                inputBg: '#fff'
            },
            dark: {
                text: '#F8F9FA',
                bg: '#202124',
                cardBg: '#303134',
                btnText: '#fff',
                inputBg: '#303134'
            }
        };

        const themes = {
            default: {
                primary: '#4285F4',
                secondary: '#34A853',
                accent: '#EA4335',
                gradient: 'linear-gradient(135deg, var(--bg), var(--bg))'
            },
            chrome: {
                primary: '#4285F4',
                secondary: '#0F9D58',
                accent: '#DB4437',
                gradient: 'linear-gradient(135deg, var(--bg), var(--bg))'
            },
            neon: {
                primary: '#00F0FF',
                secondary: '#00FF9D',
                accent: '#FF00C8',
                gradient: 'linear-gradient(135deg, var(--bg), var(--bg))'
            }
        };

        function updateTheme(theme) {
            const selectedTheme = themes[theme];
            if (!selectedTheme) return;
            
            document.documentElement.style.setProperty('--primary', selectedTheme.primary);
            document.documentElement.style.setProperty('--secondary', selectedTheme.secondary);
            document.documentElement.style.setProperty('--accent', selectedTheme.accent);
            document.documentElement.style.setProperty('--theme-gradient', selectedTheme.gradient);
            
            localStorage.setItem('theme', theme);
        }

        function updateStyle(style) {
            const selectedStyle = styles[style];
            if (!selectedStyle) return;
            
            document.documentElement.style.setProperty('--text', selectedStyle.text);
            document.documentElement.style.setProperty('--bg', selectedStyle.bg);
            document.documentElement.style.setProperty('--card-bg', selectedStyle.cardBg);
            document.documentElement.style.setProperty('--btn-text', selectedStyle.btnText);
            document.documentElement.style.setProperty('--input-bg', selectedStyle.inputBg);
            
            localStorage.setItem('style', style);
        }

        function fetchProxy(url) {
            return fetch(`https://corsproxy.io/?${encodeURIComponent(url)}`)
                .then(response => response.json())
                .catch(error => console.error('Error:', error));
        }

        function generateVerificationCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = '';
            for (let i = 0; i < 6; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            localStorage.setItem('verificationCode', code);
            document.getElementById('verification-code').textContent = code;
        }

        function showStep(stepId, progress) {
            const steps = document.querySelectorAll('.step');
            steps.forEach(step => step.classList.remove('active'));
            document.getElementById(stepId).classList.add('active');
            updateProgress(progress);
        }

        function updateProgress(progress) {
            const progressBar = document.querySelector('.progress');
            progressBar.style.width = `${progress * 100}%`;
        }

        function initSteps() {
            const storedTheme = localStorage.getItem('theme') || 'default';
            const storedStyle = localStorage.getItem('style') || 'light';
            
            updateTheme(storedTheme);
            updateStyle(storedStyle);
            
            const themeOptions = document.querySelectorAll('.theme-option');
            themeOptions.forEach(option => {
                const theme = option.getAttribute('data-theme');
                option.addEventListener('click', () => updateTheme(theme));
                if (theme === storedTheme) option.classList.add('selected');
            });
            
            const styleOptions = document.querySelectorAll('.style-option');
            styleOptions.forEach(option => {
                const style = option.getAttribute('data-style');
                option.addEventListener('click', () => updateStyle(style));
                if (style === storedStyle) option.classList.add('selected');
            });

            const usernameFromUrl = window.location.pathname.split('/').pop();
            if (usernameFromUrl.startsWith('@')) {
                const storedUsername = localStorage.getItem('robloxUsername');
                if (storedUsername && storedUsername === usernameFromUrl.slice(1)) {
                    document.getElementById('main-app').classList.remove('active');
                    document.getElementById('profile-btn').addEventListener('click', () => {
                        const username = localStorage.getItem('robloxUsername');
                        if (username) {
                            window.location.href = `/@${username}`;
                        }
                    });

                    const urlUsername = window.location.pathname.split('/').pop();
                    if (urlUsername.startsWith('@')) {
                        const storedUsername = localStorage.getItem('robloxUsername');
                        if (storedUsername && storedUsername === urlUsername.slice(1)) {
                            document.getElementById('main-app').classList.remove('active');
                            document.getElementById('onboarding').style.display = 'none';
                            const userId = localStorage.getItem('robloxUserId');
                            const headshot = localStorage.getItem('robloxHeadshot');
                            const description = localStorage.getItem('robloxDescription') || '(No description)';
                            const profileHtml = `
                                <div id="profile" class="step active">
                                    <div id="profile-header">
                                        <img id="profile-headshot" src="${headshot}" alt="Profile picture">
                                        <div id="profile-info">
                                            <h1>${storedUsername}</h1>
                                            <p>${description}</p>
                                        </div>
                                    </div>
                                    <div id="profile-stats">
                                        <div class="stat">
                                            <span class="stat-value">${userId}</span>
                                            <span class="stat-label">User ID</span>
                                        </div>
                                    </div>
                                    <div id="profile-actions">
                                        <button onclick="window.location.href='/edit'">Edit Profile</button>
                                        <button onclick="document.getElementById('theme-btn').click()">Change Theme</button>
                                    </div>
                                </div>`;
                            document.getElementById('onboarding').innerHTML = profileHtml;
                        } else {
                            window.history.pushState({}, '', '/');
                            if (localStorage.getItem('newUser') === 'true') {
                                document.getElementById('step1').classList.add('active');
                                updateProgress(1);
                            }
                        }
                    }
                }
            }

            const themeBtn = document.getElementById('theme-btn');
            const themeMenu = document.getElementById('theme-menu');
            themeBtn.addEventListener('click', () => {
                themeMenu.classList.toggle('active')
            });

            document.getElementById('confirm-id').addEventListener('click',async()=>{const e=document.getElementById('roblox-id').value.trim();if(!e)return;try{const[t,n]=await Promise.all([fetchProxy(`https://users.roblox.com/v1/users/${e}`),fetchProxy(`https://thumbnails.roblox.com/v1/users/avatar-headshot?userIds=${e}&size=150x150&format=Png`)]);if(t.errors||n.errors)throw new Error('User not found');document.getElementById('username').textContent=t.name,document.getElementById('description').textContent=t.description||'(No description)',document.getElementById('headshot').src=n.data[0].imageUrl,localStorage.setItem('tempUserId',e),localStorage.setItem('tempUsername',t.name),localStorage.setItem('tempHeadshot',n.data[0].imageUrl),showStep('step2',2)}catch(e){alert("Oops! Couldn't find that user. Please check the ID and try again.")}}),
            document.getElementById('yes-btn').addEventListener('click',()=>{generateVerificationCode(),showStep('step3',3)}),
            document.getElementById('verify-btn').addEventListener('click',async()=>{const e=localStorage.getItem('tempUserId'),t=localStorage.getItem('verificationCode');try{const n=await fetchProxy(`https://users.roblox.com/v1/users/${e}`);n.description&&n.description.includes(t)?(localStorage.setItem('newUser','false'),localStorage.setItem('robloxUserId',e),localStorage.setItem('robloxUsername',localStorage.getItem('tempUsername')),localStorage.setItem('robloxHeadshot',localStorage.getItem('tempHeadshot')),['tempUserId','tempUsername','tempHeadshot','verificationCode'].forEach(e=>localStorage.removeItem(e)),document.getElementById('onboarding').style.display='none',document.getElementById('main-app').classList.add('active')):document.getElementById('verification-status').textContent='Code not found in description. Please try again.'}catch(e){document.getElementById('verification-status').textContent='Error verifying. Please try again.'}});

        document.addEventListener('DOMContentLoaded', initSteps);

        const userId = localStorage.getItem('robloxUserId');
        if (userId) {
            fetchProxy(`https://users.roblox.com/v1/users/${userId}`).then(data => {
                localStorage.setItem('robloxDescription', data.description);
            });
        }
    </script>
</body>
</html>
